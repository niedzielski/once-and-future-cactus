!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.src=a.src||{})}(this,function(a){"use strict";var b=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},c=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b},e=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},f=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},g=function(){function a(){b(this,a);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];this._keys=d}return c(a,[{key:"pressed",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this._keys[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;if(a.input.keyboard.isDown(g))return!0}}catch(a){c=!0,d=a}finally{try{!b&&f.return&&f.return()}finally{if(c)throw d}}return!1}}]),a}(),h=function(){function a(){b(this,a),this._up=new g(Phaser.Keyboard.UP,Phaser.Keyboard.W),this._right=new g(Phaser.Keyboard.RIGHT,Phaser.Keyboard.D),this._down=new g(Phaser.Keyboard.DOWN,Phaser.Keyboard.S),this._left=new g(Phaser.Keyboard.LEFT,Phaser.Keyboard.A)}return c(a,[{key:"up",value:function(a){return this._up.pressed(a)}},{key:"right",value:function(a){return this._right.pressed(a)}},{key:"down",value:function(a){return this._down.pressed(a)}},{key:"left",value:function(a){return this._left.pressed(a)}}]),a}(),i=function(){function a(){b(this,a),this._map=null,this._layers=[],this._kbd=new h}return c(a,[{key:"width",value:function(){return this._map&&this._map.widthInPixels}},{key:"height",value:function(){return this._map&&this._map.heightInPixels}},{key:"preload",value:function(a){a.stage.backgroundColor="#f4f4ed";var b=16;a.load.tilemap("lvl","static/lvl.json",null,Phaser.Tilemap.TILED_JSON),a.load.spritesheet("tileset","static/tileset.png",b,b)}},{key:"create",value:function(a){this._map=a.add.tilemap("lvl"),this._map.addTilesetImage("tileset");var b=!0,c=!1,d=void 0;try{for(var e,f=this._map.layers[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=this._map.createLayer(g.name);h.resizeWorld(),this._layers.push(h)}}catch(a){c=!0,d=a}finally{try{!b&&f.return&&f.return()}finally{if(c)throw d}}var i=a.add.group(),j=128;this._map.createFromObjects("char","player","tileset",j,!0,!1,i),i.enableBody=!0,this._player=i.getChildAt(0);var k=.5;this._player.anchor.setTo(k,0),a.physics.arcade.enable(this._player),this._player.body.collideWorldBounds=!0,a.camera.follow(this._player,Phaser.Camera.FOLLOW_PLATFORMER);var l=50;this._player.body.maxVelocity.set(l);var m=300;this._player.body.drag.set(m)}},{key:"update",value:function(a){var b=this._player.body.velocity,c=10;this._kbd.up(a)&&(b.y-=c),this._kbd.right(a)&&(b.x+=c),this._kbd.down(a)&&(b.y+=c),this._kbd.left(a)&&(b.x-=c)}},{key:"render",value:function(a){a.debug.body(this._player)}},{key:"resize",value:function(a){var b=this;this._layers.forEach(function(a){return a.resize(b.width(),b.height())}),a.camera.follow(this._player,Phaser.Camera.FOLLOW_PLATFORMER)}}]),a}(),j=function(a){function g(a,c){b(this,g),console.log("GameState: constructor");var e=d(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,a));return e._scene=c,e}return e(g,a),c(g,[{key:"preload",value:function(a){var b=this;f(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"preload",this).call(this,a),console.log("GameState: preload"),a.time.advancedTiming=!0,a.renderer.renderSession.roundPixels=!0,a.camera.roundPx=!1,Phaser.Canvas.setImageRenderingCrisp(a.canvas),a.load.bitmapFont("mem","static/mem.png","static/mem.fnt"),a.load.bitmapFont("mem mono","static/mem.png","static/mem-mono.fnt"),window.addEventListener("resize",function(){return b.resize()}),this._scene.preload(a)}},{key:"create",value:function(a){f(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"create",this).call(this,a),console.log("GameState: create"),this._scene.create(a);var b=4;this._fpsText=a.add.bitmapText(1,1,"mem mono","0",b),this._fpsText.fixedToCamera=!0,this.resize();var c=20;a.add.bitmapText(c,1,"mem","Once & Future Cactus",b)}},{key:"update",value:function(a){f(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"update",this).call(this,a),this._scene.update(a)}},{key:"render",value:function(a){f(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"render",this).call(this,a),this._scene.render(a);var b=String(a.time.fps);this._fpsText.text=b.length<2?"0"+b:b}},{key:"resize",value:function(){var a=window.innerHeight/this._scene.height(),b=Math.ceil(window.innerWidth/a),c=Math.ceil(this._scene.height());console.log("GameState: resize scale="+a+" "+("native="+b+"x"+c+" ")+("scene="+this._scene.width()+"x"+this._scene.height()+" ")+("window="+window.innerWidth+"x"+window.innerHeight+" ")+("ratio="+window.innerWidth/window.innerHeight)),this.game.scale.setGameSize(b,c),this.game.camera.bounds=new Phaser.Rectangle(0,0,this._scene.width(),this._scene.height()),this._scene.resize(this.game)}}]),g}(Phaser.State),k=function(a){function f(){b(this,f);var a=d(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,{transparent:!1,antialias:!1,renderer:Phaser.AUTO}));return a._gameState=new j(a,new i),a}return e(f,a),c(f,[{key:"init",value:function(){this.state.add("GameState",this._gameState,!0)}}]),f}(Phaser.Game);(new k).init(),Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map